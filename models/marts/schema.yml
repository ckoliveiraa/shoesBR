version: 2

models:
  - name: dim_clientes
    description: "Tabela mart consolidando dados de clientes e compras."
    columns:
      - name: customer_id
        description: "Identificador único do cliente."
        tests:
          - unique
          - not_null
      - name: customer_name
        description: "Nome completo do cliente."
      - name: customer_address
        description: "Endereço do cliente."
      - name: customer_phone
        description: "Número de telefone do cliente."
      - name: customer_email
        description: "E-mail do cliente."
      - name: total_gasto
        description: "Total gasto pelo cliente."
      - name: total_compras
        description: "Número total de compras realizadas pelo cliente."

  - name: dim_produtos
    description: "Tabela mart consolidando dados de produtos e vendas."
    columns:
      - name: product_id
        description: "Identificador único do produto."
        tests:
          - unique
          - not_null
      - name: name_product
        description: "Nome do produto."
      - name: price_product
        description: "Preço do produto."
      - name: total_vendido
        description: "Quantidade total vendida do produto."
      - name: total_faturado
        description: "Valor total faturado com o produto."

  - name: fact_vendas
    description: "Tabela mart consolidando vendas e estornos."
    columns:
      - name: purchase_id
        description: "Identificador único da venda."
        tests:
          - unique
          - not_null
      - name: customer_id
        description: "Identificador do cliente."
        tests:
          - relationships:
              to: ref('mart_clientes')
              field: customer_id
      - name: product_id
        description: "Identificador do produto."
        tests:
          - relationships:
              to: ref('mart_produtos')
              field: product_id
      - name: purchase_date
        description: "Data da compra."
      - name: quantity
        description: "Quantidade de produtos comprados."
      - name: total_price
        description: "Preço total da compra."
      - name: payment_method
        description: "Método de pagamento utilizado."
      - name: valor_estornado
        description: "Valor estornado na compra."
      - name: refund_reason
        description: "Motivo do estorno, caso tenha ocorrido."